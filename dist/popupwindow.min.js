!function(e,t){"function"==typeof define&&define.amd?define("PopupWindow",["jquery"],t):"undefined"!=typeof exports?exports.PopupWindow=t(e.jQuery||e.$):"undefined"!=typeof require&&require.register?require.register("kevinkl3/popupwindow",function(i,s,n){n.exports=t(e.jQuery||e.$)}):e.PopupWindow=t(e.jQuery||e.$)}(this,function(e){var t=function(i){if(this==t)return new t(i);var s={title:"-",width:500,height:300,resizable:!0,content:"",position:{x:600,y:300},style:{},attrs:{},"class":"",fixed:!0,theme:"dark",titleHeight:30,minWidth:300,minHeight:100,initialZIndex:1100,container:null,constrainToContainer:!1};i=e.extend(s,i),this.version="v0.1";var n=this;this.onMouseMove=function(e){window.getSelection&&window.getSelection().removeAllRanges();var t=this.cx+e.clientX-this.offsetX,s=this.cy+e.clientY-this.offsetY;i.constrainToContainer&&n.bounds&&(t=Math.min(Math.max(t,n.bounds.left),n.bounds.right),s=Math.min(Math.max(s,n.bounds.top),n.bounds.bottom)),n.jel.css("left",t),n.jel.css("top",s)},this.close=function(){n.jel.trigger("closePopup").remove()},this.onResize=function(e){e.clientX-n.cx>=i.minWidth&&n.jel.css("width",e.clientX-n.cx),e.clientY-n.cy>=i.minHeight&&n.jel.css("height",e.clientY-n.cy)},this.getContentDiv=function(){return n.contentDiv},this.refreshBounds=function(){n.container&&(n.bounds={top:n.container.offset().top,left:n.container.offset().left,bottom:n.container.offset().top+n.container.height()-n.jel.height(),right:n.container.offset().left+n.container.width()-n.jel.width()})},this.jel=e("<div></div>"),this.el=this.jel[0];var o=this.jel;this.titleDiv=e("<div></div>"),this.closeBtn=e('<a href="#"></a>'),this.contentDiv=e("<div></div>"),i.container&&(this.container=i.container.jquery?i.container:e(i.container)),(this.container||e("body")).append(this.el);var r=this.titleDiv,c=this.contentDiv;o.addClass("PopupWindow"),o.addClass(i.theme),o.css("position",i.fixed?"fixed":"absolute"),o.css("width",i.width),o.css("height",i.height),o.css("z-index",i.initialZIndex);var d=i.position.x,l=i.position.y;n.container&&i.constrainToContainer&&(n.refreshBounds(),d=Math.min(Math.max(d,n.bounds.left),n.bounds.right),l=Math.min(Math.max(l,n.bounds.top),n.bounds.bottom),console.log(d,l,n.bounds)),o.css("top",l),o.css("left",d),e.each(i.style,function(e,t){o.css(e,t)}),e.each(i.attrs,function(e,t){o.attr(e,t)}),o.addClass(i.class),r.addClass("PopupWindow-Title"),r.addClass(i.theme),r.html(i.title),r.css("height",i.titleHeight),this.closeBtn.css("float","right"),this.closeBtn.click(n.close),this.closeBtn.addClass("close-button"),c.addClass("PopupWindow-Content"),c.addClass(i.theme),c.html(i.content),r.append(this.closeBtn),i.title.length>0&&o.append(r),o.append(c),r.mousedown(function(e){t.mousedown||2==e.button||(n.jel.css("z-index",t.zi++),n.offsetX=e.clientX,n.offsetY=e.clientY,n.cx=parseInt(n.jel.css("left")),n.cy=parseInt(n.jel.css("top")),n.refreshBounds(),t.current=n,t.mousedown=!0)}),c.click(function(){n.jel.css("z-index",t.zi++)}),r.mouseup(function(){t.current=null,t.mousedown=!1}),t.binded?n.jel.css("z-index",t.zi++):(t.binded=!0,e(document).mousemove(function(){return t.mousedown||null!=t.current||null!=t.resize||t.doresize?(t.mousedown?t.current.onMouseMove.apply(t.current,arguments):t.doresize&&t.resize.onResize.apply(t.current,arguments),!1):!0}),e(document).mouseup(function(){t.current=null,t.doresize&&n.jel.trigger("resizePopup"),t.mousedown=!1,t.doresize=!1}),t.zi=i.initialZIndex),i.resizable&&(this.resizeLb=e("<div></div>"),this.resizeLb.css("position","absolute"),this.resizeLb.css("bottom","0"),this.resizeLb.css("right","0"),this.resizeLb.css("width","10px"),this.resizeLb.css("height","10px"),this.resizeLb.css("cursor","se-resize"),this.contentDiv.append(this.resizeLb),o.css("resize","both"),this.resizeLb.mousedown(function(e){t.doresize||2==e.button||(n.jel.css("z-index",t.zi++),t.resize=n,t.doresize=!0,n.cx=parseInt(n.jel.css("left")),n.cy=parseInt(n.jel.css("top")))}))};return t});